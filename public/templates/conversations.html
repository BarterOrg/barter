<div class="box conversations" data-ng-init="renderMessages()">
  <h1><a href="#" class="barterLogo">Barter</a></h1>
  <button ng-click="loopPostsAndConvs(match, match, match, match)">All Trades</button>
  <button ng-click="loopPostsAndConvs(notMatch, match, match, notMatch)">Pending</button>
  <button ng-click="loopPostsAndConvs(match, notMatch, match, notMatch)">Accepted</button>
  <button ng-click="loopPostsAndConvs(match, notMatch, match, notMatch)">Completed</button>
  <button ng-click="loopPosts(match, notMatch)">Your Posts</button>
  <button ng-click="loopPosts(notMatch, match)">Your Requests</button>
  <section class="conversationsContainer">
    <div class="conversationContainer" ng-repeat="post in posts | orderBy:'createdAt':true" ng-show="post.show">
      <div class="imageContainer">
        <img src={{post.image}}></img>
        <button class="deletePost" ng-click="deletePost(post, posts)">Delete Post</button>
      </div>
      <div class="postDescription">
        <p><span class="underline">Item Name</span>: {{post.itemName}}</p>
        <p><span class="underline">Description</span>: {{post.description}}</p>
        <p><span class="underline">Condition</span>:  {{post.condition}}</p>
        <p><span class="underline">Contact</span> {{post.name}}</p>
        <div class="conversation" ng-repeat="conversation in post.conversations | orderBy:'createdAt':true" ng-show="conversation.show">
          <div>
            <hr/>
            <h4><span class="underline">Conversation</span>:</h4>
            <h4>Topic: {{post.itemName}}</h4>
            <button ng-click="toggleConversationModal(conversation)">View Conversation!</button>
          </div>
        </div>
      </div>
    </div>
  </section>
  <div ng-click="toggleConversationModal()" class="modalMask" ng-show="conversationModalShow"></div>
  <div class="modal" ng-show="conversationModalShow">
    <button ng-click="respondToBarter(modalConversation, 'acceptBarter')">Accept Barter</button>
    <button ng-click="respondToBarter(modalConversation, 'rejectBarter')">Reject Barter</button>
    <button ng-click="deleteConversation(modalConversation, post)">Delete Conversation</button>
    <div class="messageContainer">
      <div class="messages" ng-repeat="message in modalConversation.messages | orderBy:'sentAt':false" >
        <p><span class="underline">{{message.from}}</span>: {{message.message}}</p>
        <p class="date"><span class="underline">Sent</span>: {{message.sentAt | date:'MM/dd/yyyy @ h:mma'}}</p>
      </div>
      <form ng-submit="sendMessage(modalConversation)">
        <input type="text" ng-model="modalConversation.reply" placeholder="Type a message!"></input>
        <button>Send</button>
        {{replyMessage}}
      </form>
    </div>
  </div>
</div>
